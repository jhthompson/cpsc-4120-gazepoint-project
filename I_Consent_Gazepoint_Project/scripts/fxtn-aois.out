
R version 3.5.0 (2018-04-23) -- "Joy in Playing"
Copyright (C) 2018 The R Foundation for Statistical Computing
Platform: x86_64-w64-mingw32/x64 (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

  Natural language support but running in an English locale

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> library(RColorBrewer)
> library(colorspace)
> library(sciplot)
> library(psych)
> library(car)
> library(reshape)
> library(plyr)
> library(ggplot2)
> 
> #subj,stimulus,timestamp,x,y,duration,prev_sacc_amplitude,aoi_label
> df = read.table("fxtn-aois.csv",sep=",",header=TRUE)
> 
> df$subj <- factor(df$subj)
> df$stimulus <- factor(df$stimulus)
> df$aoi_label <- factor(df$aoi_label)
> 
> attach(df)
> 
> fit_type1 <- aov(duration ~ (stimulus * aoi_label) + Error(subj/(stimulus)))
> #fit_type1 <- aov(duration ~ (stimulus * aoi_label))
> summary(fit_type1)

Error: subj
         Df Sum Sq Mean Sq
stimulus  3  3.155   1.052

Error: subj:stimulus
          Df Sum Sq Mean Sq
stimulus   3 0.6574  0.2191
aoi_label  9 1.1523  0.1280

Error: Within
            Df Sum Sq Mean Sq F value   Pr(>F)    
aoi_label   23   1.30 0.05652   2.432 0.000176 ***
Residuals 1525  35.44 0.02324                     
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
> #print(model.tables(fit_type1,"means"),digits=3)
> pairwise.t.test(duration, stimulus, paired=FALSE, p.adjust="bonf")

	Pairwise comparisons using t tests with pooled SD 

data:  duration and stimulus 

                   calibration-verification-image-fxtn-aoi.csv
page1-fxtn-aoi.csv 9.2e-08                                    
page2-fxtn-aoi.csv 0.0016                                     
page3-fxtn-aoi.csv 0.0011                                     
                   page1-fxtn-aoi.csv page2-fxtn-aoi.csv
page1-fxtn-aoi.csv -                  -                 
page2-fxtn-aoi.csv 1.0000             -                 
page3-fxtn-aoi.csv 1.0000             1.0000            

P value adjustment method: bonferroni 
> describeBy(x=duration,group=stimulus)

 Descriptive statistics by group 
group: calibration-verification-image-fxtn-aoi.csv
   vars   n mean   sd median trimmed  mad  min  max range skew kurtosis   se
X1    1 337 0.18 0.24   0.08    0.12 0.09 0.01 1.64  1.63 2.85    10.08 0.01
------------------------------------------------------------ 
group: page1-fxtn-aoi.csv
   vars   n mean   sd median trimmed  mad  min  max range skew kurtosis se
X1    1 763 0.12 0.13   0.08    0.09 0.08 0.01 1.03  1.02 2.71    11.24  0
------------------------------------------------------------ 
group: page2-fxtn-aoi.csv
   vars   n mean   sd median trimmed  mad  min  max range skew kurtosis   se
X1    1 331 0.13 0.15    0.1     0.1 0.09 0.02 1.53  1.52 3.99     25.2 0.01
------------------------------------------------------------ 
group: page3-fxtn-aoi.csv
   vars   n mean   sd median trimmed mad  min  max range skew kurtosis   se
X1    1 133 0.11 0.11    0.1     0.1 0.1 0.01 0.86  0.84    3     16.6 0.01
> 
> pdf.options(family="NimbusSan",useDingbats=FALSE)
> plotName = "./duration-CI.pdf"
> pdf(plotName)
> bargraph.CI(stimulus,
+             duration,
+             group=aoi_label,
+             data=df,
+             split = FALSE,
+             col = "black",
+             angle = c(45,45),
+             density = c(0,20),
+             lc = FALSE,
+             uc = TRUE,
+             legend = TRUE,
+ #           ylim = c(0,40),
+             xlab = "Stimulus",
+             ylab = "Fixation Duration (sec; with SE)",
+             cex.lab = 1.2,
+             names.arg = c("painting","puntos"),
+             cex.names = 1.1,
+             main = "Fixation Duration in AOIs vs. Image Type"
+ )
